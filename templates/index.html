<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dockeré•œåƒåŒæ­¥å·¥å…·</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
</head>
<body>
    <div class="container-fluid">
        <!-- å¯¼èˆªæ  -->
        <nav class="navbar navbar-dark bg-primary mb-4">
            <div class="container">
                <span class="navbar-brand">ğŸ³ Dockeré•œåƒåŒæ­¥å·¥å…·</span>
                <div class="navbar-nav-right d-flex align-items-center">
                    <!-- ç”¨æˆ·ä¿¡æ¯ -->
                    <div class="user-info me-3">
                        <span class="text-white me-2">
                            <i class="fas fa-user"></i>
                            <span id="user-display-name">åŠ è½½ä¸­...</span>
                        </span>
                        <span class="badge bg-success me-2" id="user-role">ç”¨æˆ·</span>
                    </div>
                    
                    <!-- è¿æ¥çŠ¶æ€ -->
                    <span class="me-3">
                        <span id="connection-status" class="badge bg-secondary">è¿æ¥ä¸­...</span>
                    </span>
                    
                    <!-- ç”¨æˆ·èœå• -->
                    <div class="dropdown">
                        <button class="btn btn-outline-light btn-sm dropdown-toggle" type="button" id="userMenuDropdown" data-bs-toggle="dropdown">
                            <i class="fas fa-cog"></i>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li>
                                <span class="dropdown-item-text">
                                    <small class="text-muted">ç™»å½•æ—¶é—´:</small><br>
                                    <small id="login-time">-</small>
                                </span>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <!-- ç®¡ç†å‘˜åŠŸèƒ½å…¥å£ -->
                            <li id="admin-menu-item" style="display: none;">
                                <a class="dropdown-item" href="/admin">
                                    <i class="fas fa-user-shield me-2"></i>ç®¡ç†æ§åˆ¶é¢æ¿
                                </a>
                            </li>
                            <li id="admin-divider" style="display: none;"><hr class="dropdown-divider"></li>
                            <li>
                                <button class="dropdown-item" type="button" onclick="changePassword()">
                                    <i class="fas fa-key me-2"></i>ä¿®æ”¹å¯†ç 
                                </button>
                            </li>
                            <li>
                                <button class="dropdown-item text-danger" type="button" onclick="logout()">
                                    <i class="fas fa-sign-out-alt me-2"></i>é€€å‡ºç™»å½•
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>

        <div class="container">
            <div class="row">
                <!-- ä¸Šæ–¹é…ç½®é¢æ¿ -->
                <div class="col-12">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5><i class="fas fa-cog"></i> åŒæ­¥é…ç½®</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <!-- é…ç½®é¡¹åŒºåŸŸ -->
                                <div class="col-md-8">
                                    <form id="sync-form">
                                        <!-- é•œåƒåˆ—è¡¨ -->
                                        <div class="form-group">
                                            <label for="images-input">
                                                <i class="fas fa-images"></i> é•œåƒåˆ—è¡¨
                                                <small class="text-muted">(æ¯è¡Œä¸€ä¸ªé•œåƒ)</small>
                                            </label>
                                            <textarea id="images-input" class="form-control images-textarea" rows="10" 
                                                      placeholder="ä¾‹å¦‚ï¼š&#10;nginx:latest&#10;redis:6.2&#10;mysql:8.0&#10;ubuntu:20.04&#10;&#10;# å¯ä»¥æ·»åŠ æ³¨é‡Šè¡Œ&#10;# æ”¯æŒå¤šç§é•œåƒæ ¼å¼"></textarea>
                                            <small class="form-text text-muted">
                                                æ”¯æŒæ ¼å¼ï¼šé•œåƒå:æ ‡ç­¾ æˆ– å®Œæ•´é•œåƒåœ°å€ï¼Œæ”¯æŒ#æ³¨é‡Šè¡Œ
                                            </small>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-6">
                                                <!-- ç›®æ ‡ç§æœ -->
                                                <div class="form-group">
                                                    <label for="target-registry">
                                                        <i class="fas fa-server"></i> ç›®æ ‡ç§æœ
                                                    </label>
                                                    <select id="target-registry" class="form-control" required>
                                                        <option value="">è¯·é€‰æ‹©ç§æœ...</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <!-- ç›®æ ‡é¡¹ç›®/å‘½åç©ºé—´ -->
                                                <div class="form-group">
                                                    <label for="target-project">
                                                        <i class="fas fa-folder"></i> ç›®æ ‡é¡¹ç›®/å‘½åç©ºé—´
                                                        <span class="help-icon" title="æŒ‡å®šé•œåƒæ¨é€åˆ°çš„é¡¹ç›®æˆ–å‘½åç©ºé—´ï¼Œç•™ç©ºä½¿ç”¨é…ç½®æ–‡ä»¶é»˜è®¤å€¼" onclick="showProjectHelp()">â“</span>
                                                    </label>
                                                    <input type="text" id="target-project" class="form-control" 
                                                           placeholder="ä¾‹å¦‚ï¼šlibraryã€myprojectã€dev-images">
                                                    <small class="form-text text-muted">
                                                        é•œåƒå°†æ¨é€åˆ°æŒ‡å®šé¡¹ç›®ä¸‹ï¼Œç•™ç©ºä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„é»˜è®¤å€¼
                                                    </small>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-6">
                                                <!-- æ›¿æ¢çº§åˆ« -->
                                                <div class="form-group">
                                                    <label for="replace-level">
                                                        <i class="fas fa-exchange-alt"></i> æ›¿æ¢çº§åˆ«
                                                        <span class="help-icon" title="ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†è¯´æ˜" onclick="showReplaceLevelHelp()">â“</span>
                                                    </label>
                                                    <select id="replace-level" class="form-control" title="é€‰æ‹©é•œåƒè·¯å¾„çš„æ›¿æ¢çº§åˆ«">
                                                        <option value="all" title="æ›¿æ¢æ‰€æœ‰çº§ï¼š'a/b/c/d/img' -> 'ns/img'">æ›¿æ¢æ‰€æœ‰çº§</option>
                                                        <option value="none" title="æ— æ›¿æ¢ï¼š'a/b/c/d/img' -> 'ns/a/b/c/d/img'">æ— æ›¿æ¢</option>
                                                        <option value="1" selected title="æ›¿æ¢1çº§ï¼š'a/b/c/d/img' -> 'ns/b/c/d/img'">æ›¿æ¢1çº§(é»˜è®¤)</option>
                                                        <option value="2" title="æ›¿æ¢2çº§ï¼š'a/b/c/d/img' -> 'ns/c/d/img'">æ›¿æ¢2çº§</option>
                                                        <option value="3" title="æ›¿æ¢3çº§ï¼š'a/b/c/d/img' -> 'ns/d/img'">æ›¿æ¢3çº§</option>
                                                    </select>
                                                    <small class="form-text text-muted">
                                                        é€‰æ‹©é•œåƒè·¯å¾„çš„æ›¿æ¢çº§åˆ«ï¼Œé¼ æ ‡æ‚¬æµ®æŸ¥çœ‹è§„åˆ™è¯´æ˜
                                                    </small>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <!-- é¡¹ç›®é¢„è§ˆ -->
                                                <div class="form-group">
                                                    <label class="text-muted">
                                                        <i class="fas fa-eye"></i> ç›®æ ‡è·¯å¾„é¢„è§ˆ
                                                    </label>
                                                    <div id="target-preview" class="form-control-plaintext bg-light p-2 rounded text-muted small">
                                                        é€‰æ‹©ç§æœå’Œé¡¹ç›®åæ˜¾ç¤ºç›®æ ‡è·¯å¾„é¢„è§ˆ...
                                                    </div>
                                                    <small class="form-text text-muted">
                                                        å®æ—¶é¢„è§ˆé•œåƒå°†æ¨é€åˆ°çš„å®Œæ•´è·¯å¾„
                                                    </small>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- ç§æœ‰é•œåƒè®¤è¯ -->
                                        <div class="form-group">
                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" id="use-private-auth" onchange="togglePrivateAuth()">
                                                <label class="custom-control-label" for="use-private-auth">
                                                    <i class="fas fa-lock"></i> æºé•œåƒéœ€è¦è®¤è¯ï¼ˆç§æœ‰ä»“åº“ï¼‰
                                                </label>
                                            </div>
                                            <small class="form-text text-muted">å‹¾é€‰æ­¤é¡¹å¯ä¸ºæºé•œåƒä»“åº“æä¾›è®¤è¯ä¿¡æ¯</small>
                                        </div>

                                        <!-- è®¤è¯ä¿¡æ¯è¾“å…¥æ¡†ï¼ˆé»˜è®¤éšè—ï¼‰ -->
                                        <div id="private-auth-section" class="card border-info" style="display: none;">
                                            <div class="card-header bg-light">
                                                <small><i class="fas fa-key"></i> æºä»“åº“è®¤è¯ä¿¡æ¯</small>
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="form-group mb-2">
                                                            <label for="source-username" class="small">ç”¨æˆ·å</label>
                                                            <input type="text" id="source-username" class="form-control form-control-sm" placeholder="è¾“å…¥ç”¨æˆ·å">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="form-group mb-2">
                                                            <label for="source-password" class="small">å¯†ç /Token</label>
                                                            <input type="password" id="source-password" class="form-control form-control-sm" placeholder="è¾“å…¥å¯†ç æˆ–Token">
                                                        </div>
                                                    </div>
                                                </div>
                                                <small class="text-info">
                                                    <i class="fas fa-info-circle"></i>
                                                    æ­¤è®¤è¯ä¿¡æ¯å°†åº”ç”¨äºæ‰€æœ‰æºé•œåƒçš„æ‹‰å–ï¼Œé€‚ç”¨äºåŒä¸€ä»“åº“çš„æ‰¹é‡åŒæ­¥
                                                </small>
                                            </div>
                                        </div>

                                        <!-- ç½‘ç»œä»£ç†é…ç½® -->
                                        <div class="form-group">
                                            <div class="custom-control custom-checkbox">
                                                <input type="checkbox" class="custom-control-input" id="use-proxy" onchange="toggleProxy()">
                                                <label class="custom-control-label" for="use-proxy">
                                                    <i class="fas fa-globe"></i> ä½¿ç”¨ç½‘ç»œä»£ç†ï¼ˆè§£å†³DockerHubè®¿é—®é—®é¢˜ï¼‰
                                                </label>
                                            </div>
                                            <small class="form-text text-muted">å‹¾é€‰æ­¤é¡¹é€šè¿‡ä»£ç†æœåŠ¡å™¨æ‹‰å–é•œåƒï¼Œé€‚ç”¨äºç½‘ç»œå—é™ç¯å¢ƒ</small>
                                        </div>

                                        <!-- ä»£ç†é…ç½®è¾“å…¥æ¡†ï¼ˆé»˜è®¤éšè—ï¼‰ -->
                                        <div id="proxy-section" class="card border-warning" style="display: none;">
                                            <div class="card-header bg-light">
                                                <small><i class="fas fa-network-wired"></i> ä»£ç†æœåŠ¡å™¨é…ç½®</small>
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="form-group mb-2">
                                                            <label for="proxy-http" class="small">HTTPä»£ç†</label>
                                                            <input type="text" id="proxy-http" class="form-control form-control-sm" placeholder="http://proxy.company.com:8080">
                                                            <small class="text-muted">ç”¨äºHTTPè¯·æ±‚çš„ä»£ç†åœ°å€</small>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="form-group mb-2">
                                                            <label for="proxy-https" class="small">HTTPSä»£ç†</label>
                                                            <input type="text" id="proxy-https" class="form-control form-control-sm" placeholder="http://proxy.company.com:8080">
                                                            <small class="text-muted">ç”¨äºHTTPSè¯·æ±‚çš„ä»£ç†åœ°å€</small>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group mb-2">
                                                    <label for="proxy-no-proxy" class="small">ä¸ä½¿ç”¨ä»£ç†çš„åœ°å€ï¼ˆå¯é€‰ï¼‰</label>
                                                    <input type="text" id="proxy-no-proxy" class="form-control form-control-sm" placeholder="localhost,127.0.0.1,*.local">
                                                    <small class="text-muted">é€—å·åˆ†éš”çš„ä¸éœ€è¦ä»£ç†çš„åœ°å€æˆ–åŸŸå</small>
                                                </div>
                                                <div class="alert alert-warning mb-0">
                                                    <small>
                                                        <i class="fas fa-exclamation-triangle"></i>
                                                        <strong>æç¤ºï¼š</strong>é€šå¸¸HTTPå’ŒHTTPSä»£ç†åœ°å€ç›¸åŒã€‚å¦‚æœåªå¡«å†™HTTPä»£ç†ï¼ŒHTTPSä¹Ÿä¼šè‡ªåŠ¨ä½¿ç”¨ç›¸åŒé…ç½®ã€‚
                                                    </small>
                                                </div>
                                                <div class="alert alert-info mb-0 mt-2">
                                                    <small>
                                                        <i class="fas fa-lightbulb"></i>
                                                        <strong>æ™ºèƒ½æ’é™¤ï¼š</strong>ç³»ç»Ÿä¼šè‡ªåŠ¨å°†ç›®æ ‡ç§æœåœ°å€æ·»åŠ åˆ°ä»£ç†æ’é™¤åˆ—è¡¨ï¼Œç¡®ä¿ç§æœè®¿é—®ä¸å—å½±å“ã€‚
                                                    </small>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- æ“ä½œæŒ‰é’® -->
                                        <div class="form-group">
                                            <div class="btn-group-custom">
                                                <button type="submit" id="start-sync" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-play"></i> å¼€å§‹åŒæ­¥
                                                </button>
                                                <button type="button" id="terminate-sync" class="btn btn-danger btn-lg" style="display: none;">
                                                    <i class="fas fa-stop"></i> ç»ˆæ­¢åŒæ­¥
                                                </button>
                                                <button type="button" id="clear-images" class="btn btn-outline-secondary btn-lg" onclick="clearImagesList()">
                                                    <i class="fas fa-trash"></i> æ¸…ç©ºåˆ—è¡¨
                                                </button>
                                                <button type="button" class="btn btn-outline-info btn-lg" onclick="showReplaceLevelHelp()">
                                                    <i class="fas fa-question-circle"></i> å¸®åŠ©è¯´æ˜
                                                </button>
                                            </div>
                                        </div>
                                    </form>
                                </div>

                                <!-- ä»»åŠ¡çŠ¶æ€åŒºåŸŸ -->
                                <div class="col-md-4">
                                    <div id="task-status" class="mt-3" style="display: none;">
                                        <div class="card border-info">
                                            <div class="card-header bg-info text-white">
                                                <small><i class="fas fa-tasks"></i> å½“å‰ä»»åŠ¡çŠ¶æ€</small>
                                            </div>
                                            <div class="card-body">
                                                <div class="progress mb-2">
                                                    <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" 
                                                         role="progressbar" style="width: 0%"></div>
                                                </div>
                                                <div id="progress-text" class="text-center small"></div>
                                                <div id="current-image" class="text-muted small mt-1"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- ä¸‹æ–¹æ—¥å¿—é¢æ¿ -->
                <div class="col-12">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5><i class="fas fa-terminal"></i> åŒæ­¥æ—¥å¿—</h5>
                            <button id="clear-logs" class="btn btn-sm btn-outline-secondary">
                                <i class="fas fa-trash"></i> æ¸…ç©ºæ—¥å¿—
                            </button>
                        </div>
                        <div class="card-body p-0">
                            <div id="log-container" class="log-container">
                                <div class="text-center text-muted p-4">
                                    <i class="fas fa-info-circle"></i>
                                    ç­‰å¾…å¼€å§‹åŒæ­¥ä»»åŠ¡...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- åº•éƒ¨ä¿¡æ¯ -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card bg-light">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6><i class="fas fa-info-circle"></i> ä½¿ç”¨è¯´æ˜</h6>
                                    <ul class="small mb-0">
                                        <li>åœ¨ä¸Šæ–¹é…ç½®é¢æ¿è¾“å…¥è¦åŒæ­¥çš„é•œåƒåˆ—è¡¨ï¼Œæ¯è¡Œä¸€ä¸ª</li>
                                        <li>æ”¯æŒä½¿ç”¨#æ·»åŠ æ³¨é‡Šè¡Œï¼Œæ–¹ä¾¿åˆ†ç»„å’Œè¯´æ˜</li>
                                        <li><strong>ç›®æ ‡é¡¹ç›®ï¼š</strong>å¯è‡ªå®šä¹‰æŒ‡å®šé¡¹ç›®/å‘½åç©ºé—´ï¼Œç•™ç©ºä½¿ç”¨é…ç½®æ–‡ä»¶é»˜è®¤å€¼</li>
                                        <li><strong>ç§æœ‰é•œåƒï¼š</strong>å‹¾é€‰"æºé•œåƒéœ€è¦è®¤è¯"å¹¶å¡«å†™è®¤è¯ä¿¡æ¯</li>
                                        <li><strong>ç½‘ç»œä»£ç†ï¼š</strong>å‹¾é€‰"ä½¿ç”¨ç½‘ç»œä»£ç†"è§£å†³DockerHubè®¿é—®é—®é¢˜</li>
                                        <li><strong>æœ¬åœ°æ–‡ä»¶ï¼š</strong>é€‰æ‹©"æœ¬åœ°æ–‡ä»¶"å¯å¯¼å‡ºtaråŒ…ä¾›å…¶ä»–ç¯å¢ƒä½¿ç”¨</li>
                                        <li>é€‰æ‹©ç›®æ ‡ç§æœå’Œåˆé€‚çš„æ›¿æ¢çº§åˆ«</li>
                                        <li>ç‚¹å‡»"å¼€å§‹åŒæ­¥"ï¼Œå®æ—¶æŸ¥çœ‹åŒæ­¥è¿›åº¦å’Œæ—¥å¿—</li>
                                        <li>å¯éšæ—¶ç‚¹å‡»"ç»ˆæ­¢åŒæ­¥"åœæ­¢æ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6><i class="fas fa-cogs"></i> ç³»ç»Ÿè¦æ±‚</h6>
                                    <ul class="small mb-0">
                                        <li>éœ€è¦å®‰è£… <code>skopeo</code> å·¥å…·</li>
                                        <li>ç¡®ä¿ç½‘ç»œå¯ä»¥è®¿é—®æºé•œåƒä»“åº“å’Œç›®æ ‡ç§æœ</li>
                                        <li>ç§æœé…ç½®æ–‡ä»¶ä½äº <code>config/registries.yaml</code></li>
                                        <li>æ”¯æŒ Harborã€é˜¿é‡Œäº‘ACRã€Nexus ç­‰ç§æœ</li>
                                        <li><strong>ç§æœ‰é•œåƒï¼š</strong>æ”¯æŒç”¨æˆ·å/å¯†ç å’ŒTokenè®¤è¯</li>
                                        <li><strong>ç½‘ç»œä»£ç†ï¼š</strong>æ”¯æŒHTTP/HTTPSä»£ç†çªç ´ç½‘ç»œé™åˆ¶</li>
                                        <li><strong>æœ¬åœ°æ–‡ä»¶ï¼š</strong>å¯¼å‡ºçš„taråŒ…å¯ç”¨<code>docker load</code>å¯¼å…¥</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ–‡ä»¶ç®¡ç†é¢æ¿ -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5><i class="fas fa-file-archive"></i> å¯¼å‡ºæ–‡ä»¶ç®¡ç†</h5>
                            <div class="btn-group">
                                <button id="refresh-files" class="btn btn-sm btn-outline-primary">
                                    <i class="fas fa-sync-alt"></i> åˆ·æ–°
                                </button>
                                <button id="cleanup-files" class="btn btn-sm btn-outline-warning">
                                    <i class="fas fa-broom"></i> æ¸…ç†æ—§æ–‡ä»¶
                                </button>
                                <button id="auto-cleanup-files" class="btn btn-sm btn-outline-danger">
                                    <i class="fas fa-clock"></i> è‡ªåŠ¨æ¸…ç†
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="files-container">
                                <div class="text-center text-muted p-4">
                                    <i class="fas fa-folder-open"></i>
                                    æ­£åœ¨åŠ è½½æ–‡ä»¶åˆ—è¡¨...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- æ¨¡æ€æ¡† -->
    <div class="modal fade" id="errorModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">é”™è¯¯</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="error-message"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å…³é—­</button>
                </div>
            </div>
        </div>
    </div>

    <!-- æ›¿æ¢çº§åˆ«å¸®åŠ©æ¨¡æ€æ¡† -->
    <div class="modal fade" id="replaceLevelHelpModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-info text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-info-circle"></i> æ›¿æ¢çº§åˆ«è¯´æ˜
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <strong>ç¤ºä¾‹è¯´æ˜ï¼š</strong>å‡è®¾æºé•œåƒä¸º <code>a/b/c/d/img</code>ï¼Œç›®æ ‡å‘½åç©ºé—´ä¸º <code>ns</code>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>æ›¿æ¢çº§åˆ«</th>
                                    <th>è¯´æ˜</th>
                                    <th>è½¬æ¢ç»“æœ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="table-warning">
                                    <td><strong>æ›¿æ¢æ‰€æœ‰çº§</strong></td>
                                    <td>åªä¿ç•™é•œåƒåï¼Œå»é™¤æ‰€æœ‰è·¯å¾„</td>
                                    <td><code>ns/img</code></td>
                                </tr>
                                <tr>
                                    <td><strong>æ— æ›¿æ¢</strong></td>
                                    <td>ä¿ç•™å®Œæ•´çš„åŸå§‹è·¯å¾„</td>
                                    <td><code>ns/a/b/c/d/img</code></td>
                                </tr>
                                <tr class="table-success">
                                    <td><strong>æ›¿æ¢1çº§ (é»˜è®¤)</strong></td>
                                    <td>å»é™¤ç¬¬1çº§è·¯å¾„</td>
                                    <td><code>ns/b/c/d/img</code></td>
                                </tr>
                                <tr>
                                    <td><strong>æ›¿æ¢2çº§</strong></td>
                                    <td>å»é™¤å‰2çº§è·¯å¾„</td>
                                    <td><code>ns/c/d/img</code></td>
                                </tr>
                                <tr>
                                    <td><strong>æ›¿æ¢3çº§</strong></td>
                                    <td>å»é™¤å‰3çº§è·¯å¾„</td>
                                    <td><code>ns/d/img</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="alert alert-secondary">
                        <h6><i class="fas fa-lightbulb"></i> ä½¿ç”¨å»ºè®®ï¼š</h6>
                        <ul class="mb-0">
                            <li><strong>æ¨èä½¿ç”¨"æ›¿æ¢1çº§"</strong>ï¼šé€‚åˆå¤§å¤šæ•°åœºæ™¯ï¼Œå»é™¤registryåœ°å€ä¿ç•™ç»„ç»‡è·¯å¾„</li>
                            <li><strong>"æ›¿æ¢æ‰€æœ‰çº§"</strong>ï¼šé€‚åˆåªéœ€è¦é•œåƒåçš„ç®€å•åœºæ™¯</li>
                            <li><strong>"æ— æ›¿æ¢"</strong>ï¼šé€‚åˆéœ€è¦ä¿æŒå®Œæ•´è·¯å¾„ç»“æ„çš„åœºæ™¯</li>
                            <li>å¦‚æœæºé•œåƒè·¯å¾„çº§åˆ«ä¸è¶³ï¼Œä¼šè‡ªåŠ¨åªä¿ç•™é•œåƒå</li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å…³é—­</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/socket.io.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    
    <!-- é¡¹ç›®é…ç½®ç›¸å…³JavaScript -->
    <script>
        // ç›®æ ‡é¡¹ç›®å¸®åŠ©å‡½æ•°
        function showProjectHelp() {
            let helpContent = `
                <div class="modal fade" id="projectHelpModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header bg-info text-white">
                                <h5 class="modal-title">
                                    <i class="fas fa-folder"></i> ç›®æ ‡é¡¹ç›®/å‘½åç©ºé—´è¯´æ˜
                                </h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="alert alert-info">
                                    <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong>æŒ‡å®šé•œåƒæ¨é€åˆ°ç›®æ ‡ç§æœçš„é¡¹ç›®æˆ–å‘½åç©ºé—´
                                </div>
                                
                                <h6><i class="fas fa-cogs"></i> ä½¿ç”¨æ–¹å¼ï¼š</h6>
                                <ul>
                                    <li><strong>ç•™ç©ºï¼š</strong>ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„é»˜è®¤é¡¹ç›®/å‘½åç©ºé—´</li>
                                    <li><strong>è‡ªå®šä¹‰è¾“å…¥ï¼š</strong>æŒ‡å®šç‰¹å®šçš„é¡¹ç›®ï¼Œå¦‚ <code>library</code>ã€<code>myproject</code>ã€<code>dev-images</code></li>
                                </ul>
                                
                                <h6><i class="fas fa-server"></i> ä¸åŒç§æœç±»å‹ç¤ºä¾‹ï¼š</h6>
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <thead>
                                            <tr>
                                                <th>ç§æœç±»å‹</th>
                                                <th>é¡¹ç›®ç¤ºä¾‹</th>
                                                <th>æœ€ç»ˆé•œåƒè·¯å¾„</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><strong>Harbor</strong></td>
                                                <td><code>library</code></td>
                                                <td><code>harbor.example.com/library/nginx:latest</code></td>
                                            </tr>
                                            <tr>
                                                <td><strong>é˜¿é‡Œäº‘ACR</strong></td>
                                                <td><code>mynamespace</code></td>
                                                <td><code>registry.cn-hangzhou.aliyuncs.com/mynamespace/nginx:latest</code></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Nexus</strong></td>
                                                <td><code>docker-hosted</code></td>
                                                <td><code>nexus.example.com:8081/docker-hosted/nginx:latest</code></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <div class="alert alert-warning">
                                    <h6><i class="fas fa-exclamation-triangle"></i> æ³¨æ„äº‹é¡¹ï¼š</h6>
                                    <ul class="mb-0">
                                        <li>ç¡®ä¿æŒ‡å®šçš„é¡¹ç›®/å‘½åç©ºé—´åœ¨ç›®æ ‡ç§æœä¸­å·²å­˜åœ¨</li>
                                        <li>ä¸åŒç§æœçš„é¡¹ç›®/å‘½åç©ºé—´å‘½åè§„åˆ™å¯èƒ½ä¸åŒ</li>
                                        <li>å¦‚æœé¡¹ç›®ä¸å­˜åœ¨ï¼ŒåŒæ­¥å¯èƒ½ä¼šå¤±è´¥</li>
                                        <li>å»ºè®®æå‰åœ¨ç§æœä¸­åˆ›å»ºæ‰€éœ€çš„é¡¹ç›®</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">å…³é—­</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // å¦‚æœæ¨¡æ€æ¡†å·²å­˜åœ¨ï¼Œå…ˆåˆ é™¤
            const existingModal = document.getElementById('projectHelpModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            // æ·»åŠ æ¨¡æ€æ¡†åˆ°é¡µé¢
            document.body.insertAdjacentHTML('beforeend', helpContent);
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            const modal = new bootstrap.Modal(document.getElementById('projectHelpModal'));
            modal.show();
        }
        
        // æ›´æ–°ç›®æ ‡è·¯å¾„é¢„è§ˆ
        function updateTargetPreview() {
            const registrySelect = document.getElementById('target-registry');
            const projectInput = document.getElementById('target-project');
            const previewDiv = document.getElementById('target-preview');
            
            if (!registrySelect || !projectInput || !previewDiv) return;
            
            const selectedRegistry = registrySelect.value;
            const projectValue = projectInput.value.trim();
            
            if (!selectedRegistry) {
                previewDiv.textContent = 'è¯·å…ˆé€‰æ‹©ç›®æ ‡ç§æœ...';
                previewDiv.className = 'form-control-plaintext bg-light p-2 rounded text-muted small';
                return;
            }
            
            // è·å–é€‰ä¸­ç§æœçš„æ˜¾ç¤ºåç§°
            const selectedOption = registrySelect.options[registrySelect.selectedIndex];
            const registryName = selectedOption ? selectedOption.textContent : selectedRegistry;
            
            let previewText = '';
            let previewClass = 'form-control-plaintext bg-light p-2 rounded small';
            
            if (projectValue) {
                previewText = `${registryName}/${projectValue}/é•œåƒå:æ ‡ç­¾`;
                previewClass += ' text-success';
            } else {
                previewText = `${registryName}/[é…ç½®æ–‡ä»¶é»˜è®¤é¡¹ç›®]/é•œåƒå:æ ‡ç­¾`;
                previewClass += ' text-info';
            }
            
            previewDiv.textContent = previewText;
            previewDiv.className = previewClass;
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåç»‘å®šäº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            // ç»‘å®šç›®æ ‡ç§æœå’Œé¡¹ç›®è¾“å…¥æ¡†çš„changeäº‹ä»¶
            const registrySelect = document.getElementById('target-registry');
            const projectInput = document.getElementById('target-project');
            
            if (registrySelect) {
                registrySelect.addEventListener('change', updateTargetPreview);
            }
            
            if (projectInput) {
                projectInput.addEventListener('input', updateTargetPreview);
            }
            
            // åˆå§‹åŒ–é¢„è§ˆ
            updateTargetPreview();
        });
    </script>
</body>
</html> 